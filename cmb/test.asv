w = windmatlab;

% 国开债1,3,5,7,10; 国债5y                                            
[edb_data,edb_codes,~,edb_times,~,~] = w.edb('M1004263,M1004265,M1004267,M1004269,M1004271,S0059747',start_dt,end_dt,'Fill=Previous'); 
                                            
edb = array2table(edb_data,'VariableNames',edb_codes);

factors = table();

% 期限利差因子
factors.date = edb_times;
factors.sprd31 = edb.M1004265 - edb.M1004263;
factors.sprd53 = edb.M1004267 - edb.M1004265;
factors.sprd105 = edb.M1004271 - edb.M1004267;

% 流动性溢价因子, 用国开5-国债5
factors.liq5y = edb.M1004267 - edb.S0059747;


reb = find_month_dates(5,factors.date,'last'); 



